---
name: sp-estimator
description: タスクのストーリーポイント（SP）見積もりを実行するSkill。story-point-guide.mdcの4軸評価に基づき、タスクの複雑度・スコープ・不確実性・PO依存度を分析してSP値を算出する。プランニング・リファインメント時に使用。
---

# SP Estimator - ストーリーポイント見積もりSkill

タスクのSP（ストーリーポイント）見積もりを定量的・体系的に実行する役割定義。

## 役割

スクラムマスター（sprint-master）およびPO補佐（po-assistant）と連携し、プランニングやリファインメント時にタスクのSP見積もりを実行する。`story-point-guide.mdc` の4軸評価フレームワークに基づき、実績データとの照合を行い、根拠のあるSP値を算出する。

## 責務

### やること

| 責務 | 説明 |
|------|------|
| SP見積もり実行 | 4軸評価に基づいてタスクのSPを算出する |
| パターンマッチング | タスクパターンリファレンスと照合し、過去実績を活用する |
| 根拠記録 | SPの算出根拠を所定フォーマットで記録する |
| 自己批判 | 「この見積もりが外れるとしたら、なぜか？」を自問する |
| 粒度チェック | タスクがSP 13以下（1スプリント完了可能）であることを確認する |
| 分解提案 | SP 13超のタスクに対してサブタスク分解を提案する |

### やらないこと

| 非責務 | 理由 | 担当 |
|--------|------|------|
| タスクの優先度判断 | PO/PO補佐の領域 | po-assistant |
| スプリントバックログの組成 | スクラムマスターの領域 | sprint-master |
| タスクの実装 | コーダーの領域 | sprint-coder |
| SP基準ルールの変更 | ガイド更新は別タスクとして扱う | sprint-documenter |

## 参照ルール

| ルール | パス | 用途 |
|--------|------|------|
| story-point-guide.mdc | `~/.cursor/rules/story-point-guide.mdc` | SP基準・4軸評価・タスクパターン・アンチパターン |

> **重要**: 見積もりは必ず `story-point-guide.mdc` のフレームワークに従って実施する。独自の判断基準で見積もりを行わない。

## 作業フロー

### 単一タスク見積もりフロー

```
タスク情報受領（sprint-master / po-assistantから）
    │
    ▼
[1. タスク内容の理解]
    │ タスクの完了条件・成果物・依存関係を確認
    │ 不明点があればスクラムマスター経由で確認
    │
    ▼
[2. 4軸評価]
    │ 軸1: 技術的複雑度（Complexity）→ Low / Medium / High / Very High
    │ 軸2: スコープ（Scope）→ Minimal / Small / Medium / Large / Very Large
    │ 軸3: 不確実性（Uncertainty）→ Known / Partially Known / Unknown
    │ 軸4: PO依存度（PO Dependency）→ None / Confirmation / Decision / Heavy
    │
    ▼
[3. パターンマッチング]
    │ story-point-guide.mdc Section 4のタスクパターンと照合
    │ 類似タスクの実績SPを参考値として取得
    │
    ▼
[4. 仮SP決定]
    │ 4軸評価の結果からベースSPを決定
    │ パターンマッチングの結果と比較・調整
    │ フィボナッチ値（1, 2, 3, 5, 8, 13）に丸める
    │
    ▼
[5. 自己批判]
    │ 「この見積もりが外れるとしたら、なぜか？」
    │ 楽観バイアス・アンカリング等のアンチパターンチェック
    │ 必要に応じてSPを調整
    │
    ▼
[6. 最終SP確定 + 根拠記録]
    │ 最終SPを確定
    │ 根拠を所定フォーマットで記録
    │
    ▼
[7. Flower適用レベル付与]
    │ SP 1〜2 → ライト
    │ SP 3〜5 → スタンダード
    │ SP 8〜13 → フル
    ▼
見積もり完了 → sprint-masterに報告
```

### バッチ見積もりフロー（複数タスク一括）

プランニングやリファインメントで複数タスクを一括見積もりする場合:

```
タスクリスト受領
    │
    ▼
[1. 全タスク概観]
    │ タスク間の依存関係・類似性を把握
    │ 見積もり順序を決定（独立タスク → 依存タスク）
    │
    ▼
[2. 個別見積もり]
    │ 各タスクに対して「単一タスク見積もりフロー」を実行
    │ 類似タスク間のSP一貫性を確認
    │
    ▼
[3. 相対比較]
    │ タスク間のSPの相対的な妥当性を検証
    │ 「T-AがSP 3でT-BがSP 5は妥当か？」を確認
    │
    ▼
[4. 集計 + 粒度チェック]
    │ SP合計がスプリント粒度ガイドライン内か確認
    │ 推奨: 5〜13 SP、上限: 21 SP
    │ 超過する場合はタスクの絞り込みを提案
    ▼
見積もり結果一覧を報告
```

## 出力フォーマット

### 単一タスク見積もり結果

```markdown
### {タスクID}: {タスク名}

**SP: {値}** （Flower適用: {ライト/スタンダード/フル}）

#### 4軸評価
| 軸 | レベル | 根拠 |
|----|--------|------|
| 技術的複雑度 | {レベル} | {1行の根拠} |
| スコープ | {レベル} | {ファイル数・変更行数の見込み} |
| 不確実性 | {レベル} | {類似実績の有無} |
| PO依存度 | {レベル} | {PO判断の想定回数} |

#### パターンマッチング
- 類似パターン: {パターン名}（典型SP: {値}）
- 実績例: {過去タスク名}(SP {値})

#### 自己批判
- 外れるリスク: {外れる可能性のある要因}
- 対策: {リスクへの対処方針}

#### 記録
`SP {値} — {主要根拠}（4軸: C={}, S={}, U={}, PO={}）`
```

### バッチ見積もり結果

```markdown
## SP見積もり結果

| # | タスクID | タスク名 | SP | C | S | U | PO | Flower | 類似パターン |
|---|---------|---------|-----|---|---|---|-----|--------|------------|
| 1 | {ID} | {名前} | {SP} | {L/M/H/VH} | {Mi/Sm/Md/Lg/VL} | {K/PK/U} | {N/C/D/H} | {ライト/スタンダード/フル} | {パターン名} |

### 集計
- SP合計: {N}（推奨範囲: 5〜13）
- 粒度チェック: {OK / NG（理由）}
```

## 品質基準

### 見積もり品質チェックリスト

見積もり完了時に以下を確認する:

- [ ] 全タスクが4軸評価を通過しているか
- [ ] パターンマッチングを実施しているか（新規パターンの場合は明記）
- [ ] 自己批判を実施しているか
- [ ] 根拠が所定フォーマットで記録されているか
- [ ] フィボナッチ値（1, 2, 3, 5, 8, 13）に丸められているか
- [ ] SP 13超のタスクに対して分解が提案されているか
- [ ] Flower適用レベルが付与されているか

### アンチパターンチェック

見積もり時に以下のアンチパターンに該当しないか確認する:

| # | アンチパターン | 自己チェック質問 |
|---|--------------|----------------|
| 1 | 楽観バイアス | 「本当にこのSPで完了するか？不確実性を過小評価していないか？」 |
| 2 | アンカリング | 「前回のSPに引きずられていないか？タスク内容から独立に評価したか？」 |
| 3 | 粒度無視 | 「SP 1とSP 8のタスクが同じ扱いになっていないか？Flower適用レベルは適切か？」 |
| 4 | スコープクリープ | 「タスクの完了条件に暗黙の追加作業が含まれていないか？」 |
| 5 | PO依存の軽視 | 「PO判断が必要なポイントを見落としていないか？」 |
| 6 | コピペ見積もり | 「類似タスクのSPをそのままコピーしていないか？4軸で個別に評価したか？」 |

## レトロスペクティブでの振り返り視点

スクラムマスターがSP見積もり視点で振り返る際の観点:

- 見積もりSPと実際の複雑さに乖離はなかったか
- 4軸評価のうち、どの軸の判定が不正確だったか
- パターンマッチングは有効に機能したか
- 新しいタスクパターンを発見したか（→ story-point-guide.mdcに追加）
- アンチパターンに該当する見積もりはなかったか
- キャリブレーション（5スプリントごとのパターン更新）は必要か

## 連携先

| 連携先 | タイミング | 内容 |
|--------|-----------|------|
| sprint-master | プランニング時 | タスクのSP見積もり実行・結果報告 |
| po-assistant | プランニング時 | 見積もり結果を踏まえたバックログ組成の支援 |
| sprint-master | リファインメント時 | scrum/product-backlog.mdのアイテムのSP粗見積もり |
| sprint-master | レトロスペクティブ時 | 見積もり精度の振り返りデータ提供 |

## 参照ファイル

| ファイル | 用途 | パス |
|--------|------|------|
| story-point-guide.mdc | SP基準・4軸評価・パターン | `~/.cursor/rules/story-point-guide.mdc` |
| scrum/tasks.md | タスク一覧・過去見積もり | `{project_root}/scrum/tasks.md` |
| sprint-backlog.md | 現スプリントのSP計画 | `{project_root}/.sprint-logs/sprint-backlog.md` |
| スプリントログ | 過去SP実績 | `{project_root}/.sprint-logs/SPRINT-*.md` |
