スプリントの横断分析ダッシュボードを生成してください。

プロジェクト名: {プロジェクト名}

---

## 目的

過去のスプリント実績データを横断的に集計・分析し、SP消化率・ベロシティ・PO効率指標・SP精度の推移を可視化する。プロダクトオーナーがプロジェクトの健全性を一目で把握できるダッシュボードを提供する。

---

## データ収集手順

### Step 1: スプリントログの全件取得

```
{project_root}/.sprint-logs/SPRINT-*.md をGlobで全件取得する。
各ファイルのYAMLフロントマター（metrics セクション）を読み取る。
ファイル名からSPRINT番号を抽出し、番号順にソートする。
```

### Step 2: メトリクス抽出

各スプリントログのYAMLフロントマターから以下のフィールドを抽出する:

| フィールド | パス | 用途 |
|-----------|------|------|
| SPRINT ID | `sprint.id` | 識別子 |
| 日付 | `sprint.date` | 時系列 |
| ステータス | `sprint.status` | completedのみ集計対象 |
| 計画SP | `metrics.planned_sp` | ベロシティ分析 |
| 完了SP | `metrics.completed_sp` | ベロシティ分析 |
| SP消化率 | `metrics.sp_completion_rate` | 消化率推移 |
| 計画タスク数 | `metrics.tasks_planned` | タスク規模分析 |
| 完了タスク数 | `metrics.tasks_completed` | タスク完了率 |
| PO判断待ち時間 | `metrics.po_wait_time_minutes` | PO効率 |
| 自律実行率 | `metrics.autonomous_rate` | PO効率 |
| セッション有効稼働率 | `metrics.session_effective_rate` | PO効率 |
| SP一致率 | `metrics.sp_accuracy.match_rate` | SP精度 |
| 見積もり正確度 | `metrics.sp_accuracy.accuracy_rate` | SP精度 |
| 過大見積もり率 | `metrics.sp_accuracy.overestimate_rate` | SP精度 |
| 過小見積もり率 | `metrics.sp_accuracy.underestimate_rate` | SP精度 |
| キャリブレーション要否 | `metrics.sp_accuracy.calibration_needed` | SP精度 |

### Step 3: マイルストーン情報

`{project_root}/scrum/milestones.md` を読み取り、進捗サマリーテーブルを取得する。

### Step 4: バックログ健全度（オプション）

`{project_root}/scrum/tasks.md` と `{project_root}/scrum/product-backlog.md` から現在のバックログ残量を算出する。

---

## 表示フォーマット

```markdown
# 📊 Sprint Dashboard: {プロジェクト名}

**生成日時**: {YYYY-MM-DD HH:MM}
**対象**: SPRINT-{最古} 〜 SPRINT-{最新}（{N}スプリント）
**プロジェクト全体進捗**: {overall_progress}%

---

## 1. マイルストーン進捗

| マイルストーン | Phase | ステータス | 進捗率 |
|--------------|-------|-----------|--------|
| {M-ID}: {名前} | {Phase} | {status} | {progress}% |

---

## 2. ベロシティ推移

| Sprint | 日付 | 計画SP | 完了SP | 消化率 | タスク |
|--------|------|--------|--------|--------|--------|
| {ID} | {date} | {planned} | {completed} | {rate}% | {done}/{total} |

### ベロシティサマリー

| 指標 | 全期間 | 直近5スプリント | 直近10スプリント |
|------|--------|---------------|----------------|
| 平均計画SP | {N} | {N} | {N} |
| 平均完了SP | {N} | {N} | {N} |
| 平均SP消化率 | {N}% | {N}% | {N}% |
| SP消化率100%達成率 | {N}% ({M}/{K}) | {N}% | {N}% |

---

## 3. PO効率指標推移

| Sprint | PO待ち時間 | 自律実行率 | セッション稼働率 |
|--------|-----------|-----------|----------------|
| {ID} | {N}分 | {N}% | {N}% |

### PO効率サマリー

| 指標 | 全期間平均 | 直近5Sprint | トレンド |
|------|-----------|-----------|---------|
| PO判断待ち時間 | {N}分 | {N}分 | {↑/→/↓} |
| 自律実行率 | {N}% | {N}% | {↑/→/↓} |
| セッション有効稼働率 | {N}% | {N}% | {↑/→/↓} |

> トレンド: 直近5スプリントの平均 vs 全期間平均を比較。
> ↑ = 5%以上改善、→ = ±5%以内、↓ = 5%以上悪化

---

## 4. SP精度推移

| Sprint | SP一致率 | 正確度(±1) | 過大率 | 過小率 | 要キャリブ |
|--------|---------|-----------|--------|--------|-----------|
| {ID} | {N}% | {N}% | {N}% | {N}% | {Yes/No} |

### SP精度サマリー

| 指標 | 全期間平均 | 直近5Sprint | 目標 | 判定 |
|------|-----------|-----------|------|------|
| SP一致率 | {N}% | {N}% | ≥70% | {✅/⚠️/❌} |
| 見積もり正確度 | {N}% | {N}% | ≥80% | {✅/⚠️/❌} |
| 過大見積もり率 | {N}% | {N}% | ≤20% | {✅/⚠️/❌} |
| 過小見積もり率 | {N}% | {N}% | ≤10% | {✅/⚠️/❌} |

### キャリブレーション判定

| チェック項目 | 結果 | 判定 |
|------------|------|------|
| SP一致率が直近5Sprintで70%未満 | {Yes/No} | {要キャリブレーション / OK} |
| 前回キャリブレーションから5Sprint以上経過 | {Yes/No} | {定期キャリブレーション / OK} |
| 特定パターンで3回連続乖離 | {Yes/No} | {パターン別キャリブレーション / OK} |

---

## 5. バックログ健全度

| 層 | 残量 | 状態 |
|----|------|------|
| 未精緻プール（product-backlog.md） | {N}件 | {🟢/🟡/🔴} |
| 精緻済みプール（tasks.md 未着手） | {N}件 ({M}SP) | {🟢/🟡/🔴} |
| 次Sprint候補（依存解決済み） | {N}件 | {🟢/🟡/🔴} |

**総合判定**: {🟢 Healthy / 🟡 Warning / 🔴 Critical}

---

## 6. KPIサマリー（ハイライト）

| KPI | 現在値 | 目標 | 判定 |
|-----|--------|------|------|
| SP消化率（直近5Sprint平均） | {N}% | ≥80% | {✅/⚠️/❌} |
| SP一致率（直近5Sprint平均） | {N}% | ≥70% | {✅/⚠️/❌} |
| 連続100%消化スプリント数 | {N} | — | {参考値} |
| マイルストーン完了率 | {N}/{M} ({K}%) | — | {参考値} |
| バックログ健全度 | {🟢/🟡/🔴} | 🟢 | {✅/⚠️/❌} |
```

---

## オプション: フィルター・表示制御

ユーザーが以下のように指定した場合、表示内容を調整する:

| ユーザー指示 | 動作 |
|------------|------|
| 「直近5スプリント」「最近の」 | 直近5スプリントのみ表示 |
| 「直近10スプリント」 | 直近10スプリントのみ表示 |
| 「ベロシティだけ」 | セクション2のみ表示 |
| 「PO効率だけ」 | セクション3のみ表示 |
| 「SP精度だけ」 | セクション4のみ表示 |
| 「サマリーだけ」 | セクション6のみ表示 |
| 「全セクション」 | 全セクション表示（デフォルト） |
| 「{SPRINT-N}から」 | 指定スプリント以降のみ表示 |
| 「Phase {N}のみ」 | 対象フェーズ期間のスプリントのみ表示 |

---

## 表示後のアクション提案

ダッシュボード表示後、データに基づいて以下のアクション候補を提示する:

```markdown
🤔 推奨アクション:
{以下のルールに基づいて動的に生成}
```

### アクション提案ルール

| 条件 | 提案内容 |
|------|---------|
| SP消化率が直近5Sprintで80%未満 | 「SP計画を保守的に（推奨範囲の下限寄りに）調整を検討してください」 |
| SP一致率が直近5Sprintで70%未満 | 「SPキャリブレーションを推奨します（/sprint-dashboard でSP精度詳細を確認）」 |
| PO待ち時間が増加傾向 | 「自律実行モードの活用、またはpo-assistantの権限拡大を検討してください」 |
| バックログ健全度が🟡以下 | 「リファインメントセッションを推奨します」 |
| 連続100%消化が10Sprint以上 | 「SP計画を推奨上限付近まで積み増すことを検討できます」 |
| キャリブレーション要 | 「story-point-guide.mdc のSP基準キャリブレーションを実施してください」 |

---

## エラーハンドリング

| 状況 | 対応 |
|------|------|
| SPRINT-*.md が存在しない | 「スプリントログが見つかりません。少なくとも1スプリント完了後に実行してください」と案内 |
| YAMLフロントマターのパースエラー | 該当スプリントをスキップし、スキップしたスプリント番号を注記として表示 |
| metricsフィールドの欠損 | 欠損フィールドは「—」で表示。初期スプリント（フォーマット確立前）は自然に欠損する |
| sp_accuracyセクションの欠損 | SPRINT-023以前のログにはsp_accuracyがない可能性。該当列は「—」で表示 |
| milestones.md が存在しない | セクション1をスキップし、「マイルストーン情報なし」と表示 |

---

## 連携先

| 連携先 | 用途 |
|--------|------|
| `/sprint-status` | 現在のスプリント状況（リアルタイム）。/sprint-dashboard は過去実績の推移分析 |
| `/try-list` | Try管理。ダッシュボードのアクション提案からリンク |
| `project-analyzer` | プロジェクト横断分析。このコマンドの出力を project-analyzer の入力として活用可能 |
| `story-point-guide.mdc` | SP精度分析のキャリブレーション基準を参照 |

---

## 注意事項

- **パフォーマンス**: 30スプリント程度であれば全件読み込みで問題ない。100件超になった場合は直近N件に絞るオプションの活用を推奨
- **データ品質**: 初期スプリント（SPRINT-001〜008頃）はYAMLフォーマットが現在と異なる可能性がある。欠損データは「—」で表示し、集計から除外する
- **SP精度データ**: sp_accuracy セクションは SPRINT-023 以降で導入。それ以前のスプリントにはデータがない
- **PO効率指標**: SPRINT-030 で正式導入。それ以前のスプリントは推定値または「—」
